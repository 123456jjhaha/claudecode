# Claude Agent System

åŸºäº Claude Agent SDK (Python) çš„å¯æ‰©å±•æ™ºèƒ½ä½“ç³»ç»Ÿï¼Œä½¿ç”¨ FastMCP + stdio æ¶æ„ï¼Œæä¾›å®Œæ•´çš„ä¼šè¯è®°å½•å’Œå®æ—¶æ¶ˆæ¯åŠŸèƒ½ã€‚

> **æ–‡æ¡£å®šä½**ï¼šæœ¬æ–‡æ¡£æ˜¯ç³»ç»Ÿçš„**æ ¸å¿ƒæ¶æ„æ–‡æ¡£**ï¼Œåªæè¿°æ•´ä½“è®¾è®¡ç†å¿µå’Œå…³é”®æ¦‚å¿µã€‚å…·ä½“æ¨¡å—çš„å®ç°ç»†èŠ‚è¯·å‚è€ƒ[æ–‡æ¡£ç´¢å¼•](#æ–‡æ¡£ç´¢å¼•)ä¸­çš„å¯¹åº”æ–‡æ¡£ã€‚

---

## æ ¸å¿ƒç‰¹æ€§

- ğŸ“ **YAML é…ç½®é©±åŠ¨** - é€šè¿‡ç®€å•çš„ YAML æ–‡ä»¶ç®¡ç† Claude Agent å®ä¾‹
- ğŸ”§ **è‡ªåŠ¨å·¥å…·å‘ç°** - è‡ªåŠ¨æ‰«æ `tools/` ç›®å½•ï¼Œæ— éœ€è£…é¥°å™¨ï¼Œç›´æ¥å†™å¼‚æ­¥å‡½æ•°
- ğŸ—ï¸ **FastMCP + stdio æ¶æ„** - ä½¿ç”¨æ ‡å‡† MCP åè®®å’Œå­è¿›ç¨‹é€šä¿¡ï¼Œç¨³å®šå¯é 
- ğŸ”„ **é€’å½’å­å®ä¾‹** - å­å®ä¾‹ä½œä¸ºå·¥å…·ï¼Œæ”¯æŒæ— é™å±‚çº§åµŒå¥—
- âœ¨ **è‡ªåŠ¨çˆ¶å­å…³è”** - parent_session_id è‡ªåŠ¨ä¼ é€’ï¼Œå¯¹ Claude å®Œå…¨é€æ˜
- ğŸ“¡ **å­å®ä¾‹å®æ—¶è¿½è¸ª** - å­å®ä¾‹å¯åŠ¨æ—¶å³åˆ»é€šçŸ¥ï¼Œæ”¯æŒå®æ—¶æ¶ˆæ¯è®¢é˜…
- ğŸ—‚ï¸ **å·¥ä½œç©ºé—´éš”ç¦»** - æ¯ä¸ªä¼šè¯è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹å·¥ä½œç›®å½•ï¼Œé¿å…æ–‡ä»¶æ±¡æŸ“
- âš¡ **æ— çŠ¶æ€è®¾è®¡** - æ”¯æŒå¹¶å‘æŸ¥è¯¢ï¼Œçº¿ç¨‹å®‰å…¨
- ğŸ“Š **æ™ºèƒ½ä¼šè¯è®°å½•** - è‡ªåŠ¨è®°å½•æ‰€æœ‰å¯¹è¯ï¼Œæ”¯æŒå±‚çº§åŒ–å­˜å‚¨å’ŒæŸ¥è¯¢
- ğŸ” **Resume å¤šè½®å¯¹è¯** - æ”¯æŒæ¢å¤ä¹‹å‰çš„ä¼šè¯
- ğŸš€ **å®æ—¶æ¶ˆæ¯æ¨é€** - åŸºäº Redis Pub/Subï¼Œå»¶è¿Ÿ < 100ms
- ğŸ§© **ç»Ÿä¸€æŸ¥è¯¢æ¶æ„** - ä¸¤å¤§æ ¸å¿ƒç±»ï¼šä¼šè¯ç®¡ç† + ä¼šè¯æŸ¥è¯¢ï¼ŒèŒè´£æ¸…æ™°

---

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 1. FastMCP + stdio æ¶æ„

**è¿›ç¨‹éš”ç¦»**ï¼šMCP æœåŠ¡å™¨è¿è¡Œåœ¨ç‹¬ç«‹å­è¿›ç¨‹ä¸­ï¼Œå·¥å…·å´©æºƒä¸å½±å“ä¸»è¿›ç¨‹ã€‚ä½¿ç”¨ JSON-RPC over stdio é€šä¿¡ï¼Œç¬¦åˆ MCP è§„èŒƒã€‚

```
Claude SDK â†’ stdio â†’ MCP æœåŠ¡å™¨å­è¿›ç¨‹ â†’ å·¥å…·æ‰§è¡Œ â†’ ç»“æœè¿”å›
```

**è®¾è®¡åŸåˆ™**ï¼š
- éš”ç¦»æ€§ï¼šå·¥å…·æ‰§è¡Œåœ¨ç‹¬ç«‹çš„å­è¿›ç¨‹ä¸­
- ç¨³å®šæ€§ï¼šé¿å…å·¥å…·é”™è¯¯å½±å“ä¸»è¿›ç¨‹
- æ ‡å‡†åŒ–ï¼šéµå¾ª MCP åè®®è§„èŒƒ
- å¯æ‰©å±•æ€§ï¼šæ˜“äºæ·»åŠ æ–°çš„å·¥å…·ç±»å‹

### 2. ç®€åŒ–çš„å·¥å…·æ ¼å¼

**é›¶æ ·æ¿ä»£ç **ï¼šæ— éœ€è£…é¥°å™¨ï¼Œç›´æ¥å†™å¼‚æ­¥å‡½æ•°å³å¯æˆä¸ºå·¥å…·ã€‚ç³»ç»Ÿè‡ªåŠ¨å‘ç°ã€æ³¨å†Œå’Œè°ƒç”¨ã€‚

```python
# tools/calculator.py
async def add(a: int, b: int) -> int:
    """åŠ æ³•å·¥å…·"""
    return a + b
```

### 3. ç»Ÿä¸€ä¼šè¯æ¶æ„ï¼ˆæ–°è®¾è®¡ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šä¼šè¯ç³»ç»Ÿé‡‡ç”¨ä¸¤å¤§æ ¸å¿ƒç±»è®¾è®¡ï¼ŒèŒè´£æ¸…æ™°åˆ†ç¦»ã€‚

#### **ğŸ›ï¸ ä¼šè¯ç®¡ç†ç±» (SessionManager + Session)**
```python
# SessionManager - ä¼šè¯å·¥å‚å’Œç®¡ç†å™¨
class SessionManager:
    - create_session()     # åˆ›å»ºæ–°ä¼šè¯
    - get_session()        # è·å–å·²æœ‰ä¼šè¯
    - list_sessions()      # åˆ—å‡ºä¼šè¯
    - cleanup_old_sessions()  # æ¸…ç†è¿‡æœŸä¼šè¯

# Session - ä¼šè¯æ•°æ®æ¨¡å‹
class Session:
    - record_message()     # è®°å½•æ¶ˆæ¯
    - finalize()           # å®Œæˆä¼šè¯
    - get_messages()       # è·å–æ¶ˆæ¯
    - get_metadata()       # è·å–å…ƒæ•°æ®
```

#### **ğŸ” ä¼šè¯æŸ¥è¯¢ç±» (SessionQuery)**
```python
# SessionQuery - ç»Ÿä¸€æŸ¥è¯¢+è®¢é˜…æœåŠ¡
class SessionQuery:
    # åŸºç¡€æŸ¥è¯¢
    - get_session_details()      # è·å–å®Œæ•´ä¼šè¯è¯¦æƒ…
    - get_session_messages()     # è·å–ä¼šè¯æ¶ˆæ¯
    - list_sessions()            # ä»£ç†åˆ° SessionManager

    # é«˜çº§æŸ¥è¯¢
    - search_sessions()          # æœç´¢ä¼šè¯
    - get_statistics_summary()   # ç»Ÿè®¡åˆ†æ
    - export_session()           # å¯¼å‡ºåŠŸèƒ½

    # å®æ—¶è®¢é˜…
    - subscribe()               # è®¢é˜…ä¼šè¯æ¶ˆæ¯
    - è‡ªåŠ¨è¿½è¸ªå­å®ä¾‹           # ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

    # ä¼šè¯æ ‘æ„å»º
    - build_session_tree()      # é€’å½’æ„å»ºä¼šè¯å…³ç³»
    - flatten_tree()           # å±•å¹³æ ‘ç»“æ„
```

**è®¾è®¡åŸåˆ™**ï¼š
- èŒè´£åˆ†ç¦»ï¼šç®¡ç† vs æŸ¥è¯¢
- æ¥å£ç»Ÿä¸€ï¼šå•ä¸€å…¥å£è®¿é—®æ‰€æœ‰ä¼šè¯åŠŸèƒ½
- å‘åå…¼å®¹ï¼šä¿æŒç°æœ‰ API ä¸å˜
- æ‰©å±•å‹å¥½ï¼šæ–°åŠŸèƒ½æ˜“äºæ·»åŠ 

### 4. æ— çŠ¶æ€ Agent è®¾è®¡

**æ ¸å¿ƒç†å¿µ**ï¼šAgent ä¸ä¿å­˜ä»»ä½• session ä¿¡æ¯ï¼Œæ¯ä¸ªæŸ¥è¯¢è¿”å›è‡ªå·±çš„ session_idï¼Œå¤©ç„¶æ”¯æŒå¹¶å‘æŸ¥è¯¢ã€‚

**è®¾è®¡åŸåˆ™**ï¼š
- æ— çŠ¶æ€ï¼šç®€åŒ–å¹¶å‘å¤„ç†
- çº¿ç¨‹å®‰å…¨ï¼šé¿å…é”æœºåˆ¶
- å¯æ‰©å±•ï¼šæ”¯æŒæ°´å¹³æ‰©å±•
- ç‹¬ç«‹æ€§ï¼šæ¯ä¸ªæŸ¥è¯¢ç‹¬ç«‹

### 5. å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ

åŸºäº Redis Pub/Sub çš„å®æ—¶æ¶ˆæ¯æ¨é€æ¶æ„ï¼š
- æ¶ˆæ¯äº§ç”Ÿæ—¶ç«‹å³æ¨é€ï¼ˆå»¶è¿Ÿ < 100msï¼‰
- åŒå±‚å­˜å‚¨ï¼ˆRedis + JSONLï¼‰ï¼Œç¡®ä¿å¯é æ€§
- è‡ªåŠ¨é™çº§ç­–ç•¥ï¼ŒRedis ä¸å¯ç”¨æ—¶ä½¿ç”¨å†…å­˜æ¨¡å¼
è¯¦ç»†è¯´æ˜ï¼š[ä¼šè¯ç³»ç»Ÿå®Œæ•´æŒ‡å—](docs/session-guide.md)

### 6. é€’å½’å­å®ä¾‹ç³»ç»Ÿ

**æ ¸å¿ƒç†å¿µ**ï¼šå­å®ä¾‹æ˜¯å®Œæ•´çš„ AgentSystemï¼Œå¯ä»¥æ— é™åµŒå¥—ï¼Œå®ç°ä»»åŠ¡çš„åˆ†å±‚å¤„ç†ã€‚

**å…³é”®ç‰¹æ€§**ï¼š
- âœ¨ **å­å®ä¾‹å¯åŠ¨é€šçŸ¥**ï¼šå­å®ä¾‹åˆ›å»º session åï¼Œç«‹å³å‘çˆ¶ session é¢‘é“å‘å¸ƒå¯åŠ¨é€šçŸ¥
- âœ¨ **å®æ—¶è¿½è¸ª**ï¼šSessionQuery è‡ªåŠ¨ç›‘å¬é€šçŸ¥ï¼Œå®æ—¶è·å–å­ session_id å¹¶è®¢é˜…å­å®ä¾‹æ¶ˆæ¯æµ
- âœ¨ **è‡ªåŠ¨è®¢é˜…**ï¼šè®¢é˜…çˆ¶ä¼šè¯åï¼Œæ‰€æœ‰å­å®ä¾‹æ¶ˆæ¯è‡ªåŠ¨æ¨é€ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®

**è®¾è®¡åŸåˆ™**ï¼š
- é€’å½’æ€§ï¼šæ”¯æŒæ— é™å±‚çº§åµŒå¥—
- å»¶è¿Ÿæ€§ï¼šæŒ‰éœ€åˆ›å»ºï¼ŒèŠ‚çœèµ„æº
- å®æ—¶æ€§ï¼šå­å®ä¾‹å¯åŠ¨æ—¶ç«‹å³é€šçŸ¥

è¯¦ç»†è¯´æ˜ï¼š[å­å®ä¾‹ç³»ç»Ÿ](docs/sub-instances.md)

### 7. å·¥ä½œç©ºé—´éš”ç¦»ç³»ç»Ÿ

**æ ¸å¿ƒç†å¿µ**ï¼šæ¯ä¸ªä¼šè¯ï¼ˆsessionï¼‰è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹çš„å·¥ä½œç›®å½•ï¼Œå®ç°å®Œå…¨çš„æ–‡ä»¶éš”ç¦»ã€‚

**å…³é”®ç‰¹æ€§**ï¼š
- âœ¨ **è‡ªåŠ¨åˆ›å»º**ï¼šæ¯æ¬¡ `query()` è°ƒç”¨æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ä¸ºè¯¥ä¼šè¯åˆ›å»ºç‹¬ç«‹çš„å·¥ä½œç›®å½•
- âœ¨ **ç³»ç»Ÿæç¤ºæ³¨å…¥**ï¼šåœ¨ system prompt ä¸­è‡ªåŠ¨å‘ŠçŸ¥ Claude å…¶ä¸“å±å·¥ä½œç›®å½•ä½ç½®
- âœ¨ **å›ºå®šç›®å½•ç»“æ„**ï¼š`instances/{name}/sessions/{session_id}/workspace/`
- âœ¨ **Resume æ”¯æŒ**ï¼šæ¢å¤ä¼šè¯æ—¶ä½¿ç”¨åŸæœ‰å·¥ä½œç›®å½•ï¼Œä¿æŒæ–‡ä»¶è¿ç»­æ€§

**è®¾è®¡åŸåˆ™**ï¼š
- éš”ç¦»æ€§ï¼šæ¯ä¸ªä¼šè¯ç‹¬ç«‹çš„æ–‡ä»¶ç©ºé—´ï¼Œé¿å…æ±¡æŸ“
- è‡ªåŠ¨åŒ–ï¼šç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†ï¼Œæ— éœ€ç”¨æˆ·å¹²é¢„
- é€æ˜æ€§ï¼šé€šè¿‡ system prompt å‘ŠçŸ¥ Claudeï¼Œå¯¹ç”¨æˆ·é€æ˜
- æŒä¹…æ€§ï¼šå·¥ä½œç›®å½•éšä¼šè¯ä¿å­˜ï¼Œæ”¯æŒæ‰‹åŠ¨æ¸…ç†

**å·¥ä½œæµç¨‹**ï¼š
```
query() â†’ ç”Ÿæˆ session_id â†’ åˆ›å»ºå·¥ä½œç›®å½• â†’ æ³¨å…¥ system prompt â†’ Claude æ‰§è¡Œ
```

è¯¦ç»†è¯´æ˜ï¼š[å·¥ä½œç©ºé—´éš”ç¦»æŒ‡å—](docs/workspace-guide.md)

### 8. é…ç½®é©±åŠ¨çš„å®ä¾‹ç®¡ç†

**æ ¸å¿ƒç†å¿µ**ï¼šæ¯ä¸ªå®ä¾‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰å…¶è¡Œä¸ºå’Œç‰¹æ€§ã€‚

**è®¾è®¡åŸåˆ™**ï¼š
- å£°æ˜å¼ï¼šé€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰è¡Œä¸º
- çµæ´»æ€§ï¼šæ”¯æŒå¤šå±‚çº§é…ç½®è¦†ç›–
- éªŒè¯æ€§ï¼šè‡ªåŠ¨éªŒè¯é…ç½®çš„å®Œæ•´æ€§
- éš”ç¦»æ€§ï¼šæ¯ä¸ªå®ä¾‹ç‹¬ç«‹é…ç½®

è¯¦ç»†è¯´æ˜ï¼š[é…ç½®æŒ‡å—](docs/configuration.md)

---

## å…³é”®æ¦‚å¿µ

### instances ç›®å½•ç»“æ„

`instances/` ç›®å½•æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå­˜å‚¨æ‰€æœ‰ claude å®ä¾‹çš„é…ç½®å’Œæ•°æ®ï¼š

```
instances/
â””â”€â”€ {instance_name}/          # å®ä¾‹ç›®å½•
    â”œâ”€â”€ config.yaml          # å®ä¾‹é…ç½®æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
    â”œâ”€â”€ .claude/              # Claude ç›¸å…³é…ç½®
    â”‚   â”œâ”€â”€ commands/
    â”‚   â”œâ”€â”€ agents/
    â”‚   â”œâ”€â”€ skills/
    â”‚   â”œâ”€â”€ .mcp.json        # å¤–éƒ¨ MCP æœåŠ¡å™¨é…ç½®ï¼ˆå¯é€‰ï¼‰
    â”‚   â””â”€â”€ settings.json    # Claude Code è®¾ç½®ï¼ˆå¯é€‰ï¼‰
    â”œâ”€â”€ tools/                # è‡ªå®šä¹‰å·¥å…·ç›®å½•ï¼ˆå¯é€‰ï¼‰
    â”‚   â””â”€â”€ *.py             # å·¥å…·æ–‡ä»¶
    â”œâ”€â”€ agent.md             # å®ä¾‹çš„æç¤ºè¯æ–‡æ¡£
    â””â”€â”€ sessions/             # ä¼šè¯è®°å½•ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
        â””â”€â”€ {session_id}/     # æ¯ä¸ªä¼šè¯çš„ç‹¬ç«‹ç›®å½•
            â”œâ”€â”€ workspace/    # ğŸŒŸ ä¼šè¯å·¥ä½œç©ºé—´ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
            â”‚   â”œâ”€â”€ .workspace_info.json  # å·¥ä½œç©ºé—´å…ƒæ•°æ®
            â”‚   â””â”€â”€ ...       # Claude åˆ›å»ºçš„æ‰€æœ‰æ–‡ä»¶
            â”œâ”€â”€ session.jsonl # ä¼šè¯æ¶ˆæ¯è®°å½•
            â””â”€â”€ metadata.json # ä¼šè¯å…ƒæ•°æ®
```

### å­å®ä¾‹ vs Claude Code Agentsï¼ˆé‡è¦æ¦‚å¿µåŒºåˆ†ï¼‰

æœ¬ç³»ç»Ÿä½¿ç”¨"å­å®ä¾‹"ï¼Œè¿™ä¸ Claude Code çš„"agents/subagents"æ˜¯**å®Œå…¨ä¸åŒ**çš„æ¦‚å¿µï¼š

#### **å­å®ä¾‹ï¼ˆSub-Instancesï¼‰**
è¿™æ˜¯æœ¬ Agent System çš„æ ¸å¿ƒæ¦‚å¿µï¼š
- **å®šä¹‰**ï¼šå®Œæ•´çš„ AgentSystem å®ä¾‹ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„é…ç½®ã€å·¥å…·ã€ä¼šè¯è®°å½•
- **ä½œç”¨åŸŸ**ï¼šæ•´ä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä½“ç³»ç»Ÿ
- **é…ç½®ä½ç½®**ï¼š`instances/{name}/config.yaml` ä¸­çš„ `sub_claude_instances`
- **ç‰¹ç‚¹**ï¼š
  - å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - ç‹¬ç«‹çš„ session è®°å½•
  - å¯ä»¥æ— é™å±‚çº§åµŒå¥—
  - é€šè¿‡ MCP å·¥å…·è°ƒç”¨
- **ç¤ºä¾‹**ï¼š`file_analyzer_agent` æ˜¯ä¸€ä¸ªå®Œæ•´çš„å­å®ä¾‹

#### **Claude Code Agentsï¼ˆå­æ™ºèƒ½ä½“ï¼‰**
è¿™æ˜¯ Claude Code CLI çš„åŠŸèƒ½ï¼š
- **å®šä¹‰**ï¼šä¸“é—¨çš„ AI åŠ©æ‰‹è§’è‰²ï¼Œç”¨äºä»»åŠ¡å§”æ‰˜
- **ä½œç”¨åŸŸ**ï¼šå•ä¸ª Claude Code ä¼šè¯å†…
- **é…ç½®ä½ç½®**ï¼š`.claude/agents/{name}.md`ï¼ˆMarkdown æ–‡ä»¶ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£
  - è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯
  - å·¥å…·æƒé™é™åˆ¶
  - å¯é€‰æ‹©ä¸åŒæ¨¡å‹
  - è‡ªåŠ¨æˆ–æ‰‹åŠ¨è°ƒç”¨
- **ç¤ºä¾‹**ï¼š`code-reviewer` æ˜¯ä¸€ä¸ªä»£ç å®¡æŸ¥å­æ™ºèƒ½ä½“

#### **å…³é”®åŒºåˆ«å¯¹ç…§è¡¨**

| ç»´åº¦ | æœ¬ç³»ç»Ÿï¼šå­å®ä¾‹ | Claude Code: Agents |
|------|---------------|-------------------|
| **æœ¬è´¨** | å®Œæ•´çš„æ™ºèƒ½ä½“ç³»ç»Ÿ | AI è§’è‰²/åŠ©æ‰‹ |
| **é…ç½®æ ¼å¼** | YAML (config.yaml) | Markdown + YAML frontmatter |
| **ä½œç”¨èŒƒå›´** | è·¨ä¼šè¯ï¼ŒæŒä¹…åŒ– | å•ä¸ª Claude ä¼šè¯å†… |
| **å·¥å…·ç³»ç»Ÿ** | è‡ªå·±çš„ tools/ ç›®å½• | ç»§æ‰¿æˆ–é™åˆ¶çˆ¶çº§å·¥å…· |
| **ä¼šè¯ç®¡ç†** | ç‹¬ç«‹çš„ session ç³»ç»Ÿ | å…±äº«çˆ¶ä¼šè¯ä¸Šä¸‹æ–‡ |
| **è°ƒç”¨æ–¹å¼** | é€šè¿‡ MCP å·¥å…· | Task tool æˆ–è‡ªåŠ¨å§”æ‰˜ |
| **åµŒå¥—èƒ½åŠ›** | æ— é™é€’å½’åµŒå¥— | ä¸æ”¯æŒåµŒå¥— |

**ç®€å•ç†è§£**ï¼š
- **å­å®ä¾‹** = ä¸€ä¸ªå®Œæ•´çš„ "Agent åº”ç”¨"
- **Claude Code Agents** = Claude çš„ "ä¸“ä¸šé¡¾é—®å›¢é˜Ÿæˆå‘˜"

### Session ID vs Claude ID

**Session IDï¼ˆä¼šè¯IDï¼‰**ï¼š
- æ ¼å¼ï¼š`{timestamp}_{counter}_{short_hash}`
- ç¤ºä¾‹ï¼š`20251217T103000_1234_abcd1234`
- ç”¨é€”ï¼šæ ‡è¯†ä¸€æ¬¡å®Œæ•´çš„å¯¹è¯ä¼šè¯
- ç‰¹ç‚¹ï¼šç³»ç»Ÿç”Ÿæˆï¼ŒåŒ…å«æ—¶é—´æˆ³ï¼Œæ”¯æŒä¼šè¯æ¢å¤å’ŒæŸ¥è¯¢ï¼ŒæŒä¹…åŒ–ä¿å­˜

**Claude ID**ï¼š
- æ ¼å¼ï¼šç”± Claude SDK å†…éƒ¨ç®¡ç†çš„å”¯ä¸€æ ‡è¯†ç¬¦
- ç”¨é€”ï¼šæ ‡è¯†ä¸ Claude API çš„å•æ¬¡å¯¹è¯ä¼šè¯
- ç‰¹ç‚¹ï¼šä»…åœ¨å•æ¬¡æŸ¥è¯¢ç”Ÿå‘½å‘¨æœŸå†…æœ‰æ•ˆï¼ŒSDK å†…éƒ¨ç®¡ç†ï¼ŒæŸ¥è¯¢ç»“æŸåå¤±æ•ˆ

### .claude ç›®å½•é…ç½®è¯¦è§£

`.claude` ç›®å½•æ˜¯ Claude Code çš„é…ç½®ä¸­å¿ƒï¼Œæœ¬ç³»ç»Ÿåœ¨æ¯ä¸ªå®ä¾‹ä¸­éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›é…ç½®æ¥å¢å¼ºåŠŸèƒ½ã€‚

#### ç›®å½•ç»“æ„

```
instances/{instance_name}/.claude/
â”œâ”€â”€ agents/                    # Claude Code å­æ™ºèƒ½ä½“å®šä¹‰
â”‚   â””â”€â”€ {agent_name}.md       # å­æ™ºèƒ½ä½“é…ç½®ï¼ˆMarkdown + YAML frontmatterï¼‰
â”œâ”€â”€ commands/                  # è‡ªå®šä¹‰æ–œæ å‘½ä»¤
â”‚   â””â”€â”€ {command_name}.md     # å‘½ä»¤å®šä¹‰
â”œâ”€â”€ skills/                    # æŠ€èƒ½ï¼ˆè‡ªåŠ¨å‘ç°çš„èƒ½åŠ›ï¼‰
â”‚   â””â”€â”€ {skill_name}/
â”‚       â”œâ”€â”€ SKILL.md          # æŠ€èƒ½å®šä¹‰ï¼ˆå¿…éœ€ï¼‰
â”‚       â”œâ”€â”€ FORMS.md          # æ”¯æŒæ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
â”‚       â””â”€â”€ scripts/          # è¾…åŠ©è„šæœ¬ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ .mcp.json                 # MCP æœåŠ¡å™¨é…ç½®
â””â”€â”€ settings.json             # Claude Code è®¾ç½®
```

#### 1. agents/ - Claude Code å­æ™ºèƒ½ä½“

**ç”¨é€”**ï¼šå®šä¹‰ä¸“é—¨çš„ AI åŠ©æ‰‹ï¼Œç”¨äºä»»åŠ¡å§”æ‰˜ã€‚

**æ–‡ä»¶æ ¼å¼**ï¼šMarkdown æ–‡ä»¶ + YAML frontmatter

**ç¤ºä¾‹**ï¼š`.claude/agents/prompt_writer_agent.md`
```markdown
---
name: prompt_writer_agent
description: ä¸“ä¸šçš„æç¤ºè¯ä¹¦å†™æ™ºèƒ½ä½“
---

<role>
You are a professional prompt engineering specialist.
</role>

<instructions>
When given requirements, craft high-quality prompts...
</instructions>
```

**å…³é”®é…ç½®é¡¹**ï¼š
- `name`: æ™ºèƒ½ä½“åç§°
- `description`: æè¿°ï¼ˆå¸®åŠ© Claude åˆ¤æ–­ä½•æ—¶è°ƒç”¨ï¼‰

**è°ƒç”¨æ–¹å¼**ï¼š
- è‡ªåŠ¨ï¼šClaude æ ¹æ®ä»»åŠ¡è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ agent

#### 2. skills/ - æŠ€èƒ½ï¼ˆè‡ªåŠ¨å‘ç°çš„èƒ½åŠ›ï¼‰

**ç”¨é€”**ï¼šå¯é‡ç”¨çš„æ¨¡å—åŒ–èƒ½åŠ›ï¼ŒClaude ä¼šè‡ªåŠ¨åœ¨åˆé€‚æ—¶æœºä½¿ç”¨ã€‚

**ç›®å½•ç»“æ„**ï¼š
```
skills/{skill_name}/
â”œâ”€â”€ SKILL.md              # ä¸»å®šä¹‰æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ REFERENCE.md          # è¯¦ç»†å‚è€ƒï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ EXAMPLES.md           # ç¤ºä¾‹æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ scripts/              # è¾…åŠ©è„šæœ¬ï¼ˆå¯é€‰ï¼‰
    â””â”€â”€ helper.py
```

**SKILL.md ç¤ºä¾‹**ï¼š
```yaml
---
name: pdf-processing
description: Extract text, fill forms, merge PDFs
allowed-tools: Read, Bash, Write
---

# PDF Processing

Instructions for using this skill...

<examples>
Example usage...
</examples>
```

- **Skills**ï¼šè‡ªåŠ¨å‘ç°ï¼Œæ¨¡å‹å†³å®šä½¿ç”¨ï¼Œé€‚åˆé€šç”¨èƒ½åŠ›

#### 3. commands/ - è‡ªå®šä¹‰æ–œæ å‘½ä»¤

**ç”¨é€”**ï¼šå¸¸ç”¨æç¤ºè¯çš„å¿«æ·æ–¹å¼ï¼Œé€šè¿‡ `/command-name` è°ƒç”¨ã€‚

**æ–‡ä»¶æ ¼å¼**ï¼šå•ä¸ª Markdown æ–‡ä»¶

**ç¤ºä¾‹**ï¼š`.claude/commands/commit.md`
```markdown
---
description: Create a git commit
argument-hint: [message]
allowed-tools: Bash(git:*)
---

Based on current changes, create a commit with message: $ARGUMENTS
```

**ç‰¹æ®Šè¯­æ³•**ï¼š
- `$ARGUMENTS`: æ‰€æœ‰å‚æ•°
- `$1`, `$2`: å•ä¸ªå‚æ•°
- `!command`: æ‰§è¡Œå‘½ä»¤å¹¶åŒ…å«è¾“å‡º
- `@file-path`: åŒ…å«æ–‡ä»¶å†…å®¹

**ä½¿ç”¨**ï¼š
```bash
/commit "Fix bug in session handling"
```

#### 4. .mcp.json - MCP æœåŠ¡å™¨é…ç½®

**ç”¨é€”**ï¼šè¿æ¥å¤–éƒ¨å·¥å…·ã€APIã€æ•°æ®åº“ç­‰æœåŠ¡ã€‚

**ç¤ºä¾‹**ï¼š
```json
{
  "mcpServers": {
    "sequentialthinking": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-sequential-thinking"]
    },
    "github": {
      "type": "http",
      "url": "https://api.githubcopilot.com/mcp/",
      "headers": {
        "Authorization": "Bearer ${GITHUB_TOKEN}"
      }
    }
  }
}
```

**ä¼ è¾“ç±»å‹**ï¼š
- `stdio`: æœ¬åœ°è¿›ç¨‹ï¼ˆé€šè¿‡æ ‡å‡†è¾“å…¥è¾“å‡ºé€šä¿¡ï¼‰
- `http`: HTTP æœåŠ¡å™¨
- `sse`: Server-Sent Events

**å·¥å…·å‘½å**ï¼š
MCP æœåŠ¡å™¨æš´éœ²çš„å·¥å…·ä¼šè‡ªåŠ¨æ³¨å†Œä¸ºï¼š`mcp__{server_name}__{tool_name}`

#### 5. settings.json - Claude Code è®¾ç½®

**ç”¨é€”**ï¼šé¡¹ç›®çº§é…ç½®ï¼ŒåŒ…æ‹¬æƒé™ã€ç¯å¢ƒå˜é‡ã€é’©å­ç­‰ã€‚

**ç¤ºä¾‹**ï¼š
```json
{
  "permissions": {
    "allow": ["Bash(git:*)", "Read(./docs/**)"],
    "deny": ["Read(.env)", "Bash(rm:*)"]
  },
  "env": {
    "NODE_ENV": "development",
    "API_TIMEOUT_MS": "300000"
  },
  "hooks": {
    "PostToolUse": [{
      "matcher": "Bash",
      "hooks": [{"type": "command", "command": "echo 'Done'"}]
    }]
  },
  "alwaysThinkingEnabled": true,
  "model": "claude-sonnet-4-5"
}
```

**å…³é”®é…ç½®**ï¼š
- `permissions`: å·¥å…·è®¿é—®æ§åˆ¶
- `env`: ç¯å¢ƒå˜é‡ï¼ˆå¯¹æ‰€æœ‰ä¼šè¯ç”Ÿæ•ˆï¼‰
- `hooks`: äº‹ä»¶é©±åŠ¨çš„è‡ªåŠ¨åŒ–
- `enabledPlugins`: æ’ä»¶ç®¡ç†
- `model`: é»˜è®¤æ¨¡å‹è¦†ç›–
- `attribution`: Git æäº¤/PR è‡ªå®šä¹‰

#### é…ç½®ä¼˜å…ˆçº§

å¤šä¸ªä½ç½®çš„é…ç½®ä¼šæŒ‰ä¼˜å…ˆçº§åˆå¹¶ï¼š
1. **Local**ï¼ˆæœ€é«˜ï¼‰: `.claude/settings.local.json`ï¼ˆä¸æäº¤åˆ° gitï¼‰
2. **Project**: `.claude/settings.json`ï¼ˆå›¢é˜Ÿå…±äº«ï¼‰
3. **User**: `~/.claude/settings.json`ï¼ˆç”¨æˆ·å…¨å±€ï¼‰

#### å®ä¾‹ç‰¹å®šé…ç½®ç¤ºä¾‹

æœ¬ç³»ç»Ÿçš„ `prompt_writer` å®ä¾‹ä½¿ç”¨äº†ä»¥ä¸‹é…ç½®ï¼š

```
instances/prompt_writer/.claude/
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ prompt_writer_agent.md      # æç¤ºè¯ä¹¦å†™æ™ºèƒ½ä½“
â”‚   â””â”€â”€ prompt_optimizer_agent.md   # æç¤ºè¯ä¼˜åŒ–æ™ºèƒ½ä½“
â”œâ”€â”€ .mcp.json                        # Sequential Thinking MCP æœåŠ¡å™¨
â”œâ”€â”€ agent.md                         # ä¸»æ™ºèƒ½ä½“æç¤ºè¯
â””â”€â”€ settings.json                    # å®ä¾‹è®¾ç½®
```

**å…³é”®ç‚¹**ï¼š
- `.claude/` é…ç½®æ˜¯ Claude Code çš„åŠŸèƒ½ï¼Œä¸æ˜¯æœ¬ç³»ç»Ÿç‰¹æœ‰çš„
- æ¯ä¸ªå®ä¾‹å¯ä»¥æœ‰è‡ªå·±çš„ `.claude/` é…ç½®
- agentsã€skillsã€commands éƒ½æ˜¯ Claude Code åœ¨è¿è¡Œæ—¶ä½¿ç”¨çš„
- æœ¬ç³»ç»Ÿçš„"å­å®ä¾‹"æ˜¯é€šè¿‡ `config.yaml` é…ç½®çš„ï¼Œä¸ `.claude/agents/` æ— å…³

---

## é¡¹ç›®ç»“æ„

```
claude_agent_system/
â”œâ”€â”€ src/                              # æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ session/                      # ç»Ÿä¸€ä¼šè¯ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ core/                    # ğŸ›ï¸ ä¼šè¯ç®¡ç†ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ session.py          # Session æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ session_manager.py  # SessionManager ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”‚   â”œâ”€â”€ query/                   # ğŸ” ä¼šè¯æŸ¥è¯¢ç±»
â”‚   â”‚   â”‚   â””â”€â”€ session_query.py    # SessionQuery ç»Ÿä¸€æŸ¥è¯¢+è®¢é˜…
â”‚   â”‚   â”œâ”€â”€ streaming/               # ğŸŒŠ å®æ—¶æ¶ˆæ¯æµ
â”‚   â”‚   â”‚   â”œâ”€â”€ message_bus.py      # Redis æ¶ˆæ¯æ€»çº¿
â”‚   â”‚   â”‚   â””â”€â”€ stream_manager.py   # æŸ¥è¯¢æµç®¡ç†
â”‚   â”‚   â”œâ”€â”€ storage/                 # ğŸ’¾ å­˜å‚¨ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ jsonl_writer.py     # å¼‚æ­¥æ‰¹é‡å†™å…¥
â”‚   â”‚   â””â”€â”€ utils/                   # ğŸ› ï¸ å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ session_utils.py    # åŸºç¡€å·¥å…·
â”‚   â”‚       â”œâ”€â”€ query_helpers.py    # æŸ¥è¯¢è¾…åŠ©å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ session_context.py  # ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â”‚       â””â”€â”€ instance_utils.py   # å®ä¾‹å·¥å…·
â”‚   â”œâ”€â”€ workspace/                   # ğŸ—‚ï¸ å·¥ä½œç©ºé—´éš”ç¦»ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ workspace_manager.py    # WorkspaceManager æ ¸å¿ƒç®¡ç†
â”‚   â”‚   â””â”€â”€ __init__.py             # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ mcp_server/                  # MCP æœåŠ¡å™¨æ¨¡å—
â”‚   â”œâ”€â”€ agent_system.py             # ç³»ç»Ÿä¸»ç±»
â”‚   â”œâ”€â”€ config_manager.py           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ tool_manager.py             # å·¥å…·ç®¡ç†
â”‚   â”œâ”€â”€ sub_instance_adapter.py     # å­å®ä¾‹é€‚é…å™¨
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ instances/                       # å®ä¾‹ç›®å½•
â”‚   â”œâ”€â”€ demo_agent/                  # æ¼”ç¤ºå®ä¾‹
â”‚   â”œâ”€â”€ file_analyzer_agent/        # æ–‡ä»¶åˆ†æå®ä¾‹
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ docs/                           # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ session-guide.md           # â­ ä¼šè¯ç³»ç»Ÿå®Œæ•´æŒ‡å—
â”‚   â”œâ”€â”€ session-query-guide.md     # SessionQuery è¯¦ç»†ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ workspace-guide.md         # ğŸ—‚ï¸ å·¥ä½œç©ºé—´éš”ç¦»æŒ‡å—
â”‚   â”œâ”€â”€ configuration.md           # é…ç½®æŒ‡å—
â”‚   â”œâ”€â”€ tool-development.md        # å·¥å…·å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ sub-instances.md           # å­å®ä¾‹ç³»ç»Ÿ
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ scripts/                        # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ cleanup_workspaces.py      # å·¥ä½œç©ºé—´æ¸…ç†å·¥å…·
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ streaming.yaml                 # å®æ—¶æ¶ˆæ¯é…ç½®ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ requirements.txt
â””â”€â”€ CLAUDE.md                      # æœ¬æ–‡æ¡£
```

---

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨

```python
import asyncio
from src import AgentSystem

async def main():
    # åˆ›å»º Agent
    agent = AgentSystem("demo_agent")
    await agent.initialize()

    # æ‰§è¡ŒæŸ¥è¯¢
    result = await agent.query_text("è®¡ç®— 123 + 456")
    print(f"ç»“æœ: {result.result}")
    print(f"ä¼šè¯ ID: {result.session_id}")

    # Resume å¯¹è¯
    result2 = await agent.query_text(
        "å†ç®—ä¸€ä¸‹ 789",
        resume_session_id=result.session_id
    )

    agent.cleanup()

asyncio.run(main())
```

### å¯ç”¨å®æ—¶æ¶ˆæ¯ï¼ˆæ–°æ¶æ„ï¼‰

```python
import asyncio
from src import AgentSystem
from src.session import MessageBus, SessionQuery

async def main():
    # åˆ›å»º MessageBus
    message_bus = MessageBus.from_config()
    await message_bus.connect()

    try:
        # åˆ›å»º Agent
        agent = AgentSystem("demo_agent", message_bus=message_bus)
        await agent.initialize()

        # æ‰§è¡ŒæŸ¥è¯¢ï¼ˆåå°è¿è¡Œï¼‰
        query_task = asyncio.create_task(
            agent.query_text("è¯·è°ƒç”¨å­å®ä¾‹åˆ†æé¡¹ç›®")
        )

        # ç­‰å¾… session åˆ›å»º
        await asyncio.sleep(1.0)

        # è·å– session_id å¹¶å¼€å§‹è®¢é˜…
        from src.session.utils import SessionContext
        session_id = SessionContext.get_current_session()

        if session_id:
            # ğŸ‰ æ–°çš„ç»Ÿä¸€æŸ¥è¯¢æœåŠ¡
            query = SessionQuery("demo_agent", message_bus=message_bus)

            # å¼€å§‹è®¢é˜…ï¼ˆè‡ªåŠ¨è¿½è¸ªå­å®ä¾‹ï¼‰
            await query.subscribe(
                session_id=session_id,
                on_parent_message=lambda msg: print(f"[çˆ¶æ¶ˆæ¯] {msg['type']}"),
                on_child_message=lambda child_id, instance, msg: print(
                    f"[å­æ¶ˆæ¯-{instance}] {msg['type']}"
                ),
                on_child_started=lambda child_id, instance: print(
                    f"ğŸ”” å­å®ä¾‹å¯åŠ¨: {instance}"
                )
            )

            # ç­‰å¾…æŸ¥è¯¢å®Œæˆ
            result = await query_task
            await query.stop()

        agent.cleanup()
    finally:
        await message_bus.close()

asyncio.run(main())
```

### ä¼šè¯æŸ¥è¯¢ç¤ºä¾‹ï¼ˆæ–°æ¶æ„ï¼‰

```python
from src.session import SessionQuery

# åˆ›å»ºæŸ¥è¯¢å®ä¾‹
query = SessionQuery("demo_agent")

# åŸºç¡€æŸ¥è¯¢
details = query.get_session_details("20241218T140000_1000_parent123")
sessions = query.list_sessions(status="completed")

# é«˜çº§æŸ¥è¯¢
results = query.search_sessions("æ–‡ä»¶åˆ†æ", field="initial_prompt")
stats = query.get_statistics_summary(recent_days=7)

# ä¼šè¯æ ‘æ„å»º
tree = await query.build_session_tree("parent_session_id")
flat_list = query.flatten_tree(tree)

# å¯¼å‡ºåŠŸèƒ½
query.export_session("session_id", Path("export.json"), format="json")
```

æ›´å¤šç¤ºä¾‹è¯·å‚è€ƒï¼š[ä¼šè¯ç³»ç»Ÿå®Œæ•´æŒ‡å—](docs/session-guide.md)

---

## æ–‡æ¡£ç´¢å¼•

### æ ¸å¿ƒæ–‡æ¡£

- [SessionQuery å®Œæ•´ä½¿ç”¨æŒ‡å—](docs/session-query-guide.md) â­ - ç»Ÿä¸€ä¼šè¯æŸ¥è¯¢ä¸è®¢é˜…æœåŠ¡
- [æ¶ˆæ¯å¤„ç†ä¸æ˜¾ç¤ºæŒ‡å—](docs/message-handling-guide.md) ğŸ“¨ - æ­£ç¡®å¤„ç†å’Œæ˜¾ç¤ºç³»ç»Ÿæ¶ˆæ¯çš„å®Œæ•´æŒ‡å—
- [ä¼šè¯ç³»ç»Ÿå®Œæ•´æŒ‡å—](docs/session-guide.md) - ä¼šè¯ç®¡ç†å’ŒæŸ¥è¯¢å®Œæ•´æŒ‡å—
- [SessionQuery è¿ç§»æŒ‡å—](docs/session-migration-guide) ğŸ”„ - ä»æ—§æ¶æ„å¹³æ»‘è¿ç§»
- [å·¥ä½œç©ºé—´éš”ç¦»æŒ‡å—](docs/workspace-guide.md) ğŸ—‚ï¸ - æ¯ä¸ªä¼šè¯çš„ç‹¬ç«‹å·¥ä½œç©ºé—´ç®¡ç†
- [é…ç½®æŒ‡å—](docs/configuration.md) - å®Œæ•´çš„é…ç½®é€‰é¡¹è¯´æ˜
- [å·¥å…·å¼€å‘æŒ‡å—](docs/tool-development.md) - åˆ›å»ºè‡ªå®šä¹‰å·¥å…·
- [å­å®ä¾‹ç³»ç»Ÿ](docs/sub-instances.md) - å­å®ä¾‹çš„ä½¿ç”¨å’Œé…ç½®

### å‚è€ƒæ–‡æ¡£
- [API å‚è€ƒ](docs/api-reference.md) - å®Œæ•´çš„ API æ–‡æ¡£
- [å¸¸è§é—®é¢˜](docs/faq.md) - FAQ å’Œæ•…éšœæ’é™¤
- [è¿ç§»æŒ‡å—](docs/migration-guide.md) - ç‰ˆæœ¬å‡çº§æŒ‡å—

---

## å¼€å‘å’Œç»´æŠ¤çº¦æŸ

### ä»£ç å¼€å‘çº¦æŸ

#### 1. æ¨¡å—åŒ–è®¾è®¡åŸåˆ™
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªæ¨¡å—å’Œç±»å¿…é¡»åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½é¢†åŸŸ
- **æ¾è€¦åˆ**ï¼šæ¨¡å—é—´ä¾èµ–æœ€å°åŒ–ï¼Œä¼˜å…ˆä½¿ç”¨æ¥å£å’ŒæŠ½è±¡
- **é«˜å†…èš**ï¼šç›¸å…³åŠŸèƒ½åº”è¯¥ç»„ç»‡åœ¨åŒä¸€ä¸ªæ¨¡å—å†…
- **å¯æµ‹è¯•æ€§**ï¼šæ‰€æœ‰æ ¸å¿ƒç»„ä»¶éƒ½å¿…é¡»æ”¯æŒå•å…ƒæµ‹è¯•

#### 2. æ–‡ä»¶ç»„ç»‡æ ‡å‡†
- **ç›®å½•ç»“æ„**ï¼šä¸¥æ ¼éµå¾ªé¡¹ç›®ç»“æ„è§„èŒƒï¼Œä¸å¾—éšæ„åˆ›å»ºæ–°ç›®å½•
- **å‘½åè§„èŒƒ**ï¼š
  - æ–‡ä»¶åä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼ˆsnake_caseï¼‰
  - ç±»åä½¿ç”¨é©¼å³°å‘½åï¼ˆPascalCaseï¼‰
  - å‡½æ•°å’Œå˜é‡ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼ˆsnake_caseï¼‰
- **å¯¼å…¥é¡ºåº**ï¼šæ ‡å‡†åº“ â†’ ç¬¬ä¸‰æ–¹åº“ â†’ æœ¬åœ°æ¨¡å—
- **æ–‡æ¡£å­—ç¬¦ä¸²**ï¼šæ‰€æœ‰å…¬å…±å‡½æ•°å’Œç±»å¿…é¡»æœ‰è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²

#### 3. æ¶æ„çº¦æŸ
- **ä¾èµ–æ–¹å‘**ï¼šé«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡
- **é…ç½®é©±åŠ¨**ï¼šæ‰€æœ‰è¡Œä¸ºå¿…é¡»é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶ï¼Œç¦æ­¢ç¡¬ç¼–ç 
- **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå®šä¹‰æ˜ç¡®çš„å¼‚å¸¸ç±»å‹
- **æ—¥å¿—è§„èŒƒ**ï¼šä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—ï¼ŒåŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯

#### 4. è§£è€¦è¦æ±‚
- **æ¥å£éš”ç¦»**ï¼šä½¿ç”¨æŠ½è±¡æ¥å£éš”ç¦»å…·ä½“å®ç°
- **ä¾èµ–æ³¨å…¥**ï¼šé€šè¿‡æ„é€ å‡½æ•°æˆ–å·¥å‚æ¨¡å¼æ³¨å…¥ä¾èµ–
- **äº‹ä»¶é©±åŠ¨**ï¼šä½¿ç”¨äº‹ä»¶æ€»çº¿å¤„ç†ç»„ä»¶é—´é€šä¿¡
- **é…ç½®å¤–éƒ¨åŒ–**ï¼šæ‰€æœ‰é…ç½®å‚æ•°å¿…é¡»å¤–éƒ¨åŒ–ï¼Œæ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–

### æ–‡æ¡£ç»´æŠ¤çº¦æŸ

#### 1. æ–‡æ¡£åŒæ­¥åŸåˆ™
- **ä»£ç å˜æ›´ â†’ æ–‡æ¡£æ›´æ–°**ï¼šä»»ä½•ä»£ç ç»“æ„å˜æ›´éƒ½å¿…é¡»åŒæ­¥æ›´æ–°ç›¸å…³æ–‡æ¡£
- **å…ˆæ–‡æ¡£åå®ç°**ï¼šæ–°åŠŸèƒ½å¼€å‘å¿…é¡»å…ˆæ›´æ–°ç›¸å…³æ–‡æ¡£ï¼Œå†ç¼–å†™ä»£ç 
- **ç‰ˆæœ¬ä¸€è‡´æ€§**ï¼šæ–‡æ¡£ç‰ˆæœ¬å¿…é¡»ä¸ä»£ç ç‰ˆæœ¬ä¿æŒä¸€è‡´
- **å®¡æŸ¥æµç¨‹**ï¼šæ–‡æ¡£å˜æ›´å¿…é¡»ç»è¿‡ä»£ç å®¡æŸ¥æµç¨‹

#### 2. æ–‡æ¡£å†…å®¹çº¦æŸ
- **å‡†ç¡®æ€§**ï¼šæ‰€æœ‰æè¿°å¿…é¡»ä¸å®é™…å®ç°å®Œå…¨ä¸€è‡´
- **å®Œæ•´æ€§**ï¼šæ–°å¢ç»„ä»¶å¿…é¡»åŒ…å«å®Œæ•´çš„æ¶æ„æè¿°å’Œä½¿ç”¨è¯´æ˜
- **å¯è¯»æ€§**ï¼šä½¿ç”¨æ¸…æ™°çš„è¯­è¨€å’Œé€‚å½“çš„å›¾è¡¨è¯´æ˜å¤æ‚æ¦‚å¿µ
- **ç¤ºä¾‹ä»£ç **ï¼šæ‰€æœ‰å…¬å…± API éƒ½å¿…é¡»æä¾›ä½¿ç”¨ç¤ºä¾‹

#### 3. æ–‡æ¡£åˆ†å±‚
- **CLAUDE.md**ï¼šç³»ç»Ÿæ ¸å¿ƒæ¶æ„å’Œè®¾è®¡ç†å¿µï¼ˆæœ¬æ–‡æ¡£ï¼‰
- **åŠŸèƒ½æ–‡æ¡£**ï¼šå„æ¨¡å—çš„è¯¦ç»†å®ç°å’Œä½¿ç”¨æ–¹æ³•ï¼ˆdocs/ ç›®å½•ï¼‰
- **API æ–‡æ¡£**ï¼šå®Œæ•´çš„ API å‚è€ƒï¼ˆdocs/api-reference.mdï¼‰

### è¿åçº¦æŸçš„åæœ

#### 1. ä»£ç è´¨é‡å½±å“
- è¿åæ¨¡å—åŒ–åŸåˆ™å°†å¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•
- ä¸éµå¾ªæ–‡ä»¶ç»„ç»‡æ ‡å‡†ä¼šå½±å“å¼€å‘æ•ˆç‡å’Œä»£ç å¯è¯»æ€§
- ç¼ºä¹è§£è€¦è®¾è®¡ä¼šé™åˆ¶ç³»ç»Ÿçš„æ‰©å±•æ€§å’Œçµæ´»æ€§

#### 2. é¡¹ç›®é£é™©
- æ–‡æ¡£ä¸åŒæ­¥ä¼šå¢åŠ å¼€å‘æˆæœ¬å’Œé”™è¯¯ç‡
- æ¶æ„çº¦æŸçš„è¿åä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œæ€§èƒ½
- ä¸éµå¾ªå¼€å‘çº¦æŸä¼šå¯¼è‡´æŠ€æœ¯å€ºåŠ¡ç§¯ç´¯

#### 3. åˆè§„è¦æ±‚
- æ‰€æœ‰ä»£ç æäº¤å¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æ£€æŸ¥ï¼ˆä»£ç æ ¼å¼ã€ç»“æ„è§„èŒƒï¼‰
- æ–‡æ¡£å˜æ›´å¿…é¡»åŒ…å«åœ¨ Pull Request ä¸­
